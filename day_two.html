<html lang="ja-jp" dir="ltr" xmlns:og="http://ogp.me/ns/#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="IAMASOKUHO">
    <meta name="keywords" content="iamasokuho, iama速報, IAMAS, 情報科学芸術大学院大学">
    <title>IAMASOKUHO</title>
    <link rel="shortcut icon" href="favicon.ico" type="image/vnd.microsoft.icon">
    <link href="//cdnjs.cloudflare.com/ajax/libs/uikit/2.11.0/css/uikit.almost-flat.min.css" rel="stylesheet">
    <link href="/assets/css/jquery.fullPage.css" rel="stylesheet">
    <link href="/assets/css/style.css" rel="stylesheet">
    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/uikit/2.11.0/js/uikit.min.js"></script>
    <script src="/assets/js/three.min.js"></script>
    <script src="/assets/js/iamasokuho.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.9.1/jquery-ui.min.js"></script>
    
    <script type="text/javascript" src="assets/js/jquery.fullPage.js"></script>
    <script type="text/javascript" src="assets/js/jquery.typist.js"></script>
    <style>
        body { margin: 0; }
        canvas { width: 100%; height: 100% }
    </style>
</head>
<body>
    <script>
        $(document).ready(function() {
    
            $('head').append(
                '<style type="text/css">body {display:none;}'
            );
            $(window).load(function() {
                $('body').fadeIn("slow");
            });
            var camera, scene, renderer;
            var mesh;
            var mesh_masuo;
            var objects = [];

            // Particles
            var group;
            var container;
            var particlesData = [];
            var positions, colors;
            var pointCloud;
            var particlePositions;
            var linesMesh;

            var maxParticleCount = 1000;
            var particleCount = 400;
            var r = 900;
            var rHalf = r / 2;

            var effectController = {
                showDots: true,
                showLines: true,
                minDistance: 200,
                limitConnections: false,
                maxConnections: 100,
                particleCount: 400
            }

    
            init();
            //zoom();
            animate();

            var zoom = 1000;
            function zoom() {
                for (var i = 0; i < 50; i++) {
                    setTimeout(function(){
                        camera.position.z = zoom - 5;
                        zoom = zoom - 5; 
                    },1000);
                }
                
            }

            function init() {
                container = document.getElementById( 'container' );

                renderer = new THREE.WebGLRenderer({antialias: true});
                renderer.setPixelRatio( window.devicePixelRatio );
                renderer.setSize( window.innerWidth, window.innerHeight );
                document.body.appendChild( renderer.domElement );
    
                camera = new THREE.PerspectiveCamera( 70, window.innerWidth / window.innerHeight, 1, 1000 );
                camera.position.z = 800;
    
                scene = new THREE.Scene();

                group = new THREE.Group();
                scene.add( group );

                var segments = maxParticleCount * maxParticleCount;

                positions = new Float32Array( segments * 3 );
                colors = new Float32Array( segments * 3);
            
                var pMaterial = new THREE.PointCloudMaterial( {
                    color: 0xFFFFF,
                    size: 3,
                    blending: THREE.AdditiveBlending,
                    transparent: true,
                    sizeAttenuation: false
                } );

                particles = new THREE.BufferGeometry();
                particlePositions = new Float32Array( maxParticleCount * 3 );

                for ( var i = 0; i < maxParticleCount; i++ ) {
                    var x = Math.random() * r - r / 2;
                    var y = Math.random() * r - r / 2;
                    var z = Math.random() * r - r / 2;
            
                    particlePositions[i * 3]     = x;
                    particlePositions[i * 3 + 1] = y;
                    particlePositions[i * 3 + 2] = z;

                    // add it to the geometry
                    particlesData.push( {
                        velocity: new THREE.Vector3( -1 + Math.random() * 2, -1 + Math.random() * 2, -1 + Math.random() * 2),
                        numConnections: 0
                    });
                }

                particles.drawcalls.push( {
                    start: 0,
                    count: particleCount,
                    index: 0
                });

                particles.addAttribute( 'position', new THREE.DynamicBufferAttribute( particlePositions, 3));

                // create the particle system
                pointCloud = new THREE.PointCloud( particles, pMaterial);
                pointCloud.visible = true;
                group.add(pointCloud);
        
                var pGeometry = new THREE.BufferGeometry();
                pGeometry.addAttribute( 'position', new THREE.DynamicBufferAttribute( positions, 3));
                pGeometry.addAttribute( 'color', new THREE.DynamicBufferAttribute(colors, 3));

                pGeometry.computeBoundingSphere();

                pGeometry.drawcalls.push( {
                    start: 0,
                    count: 0,
                    index: 0
                } );

                var pMaterial = new THREE.LineBasicMaterial( {
                    vertexColors: THREE.VertexColors,
                    blending: THREE.AdditiveBlending,
                    transparent: true
                });

                linesMesh = new THREE.Line( pGeometry, pMaterial, THREE.LinePieces );
                group.add( linesMesh );

                renderer.setPixelRatio(window.devicePixelRatio);
                renderer.setSize(window.innerWidth, window.innerHeight);

                renderer.gammaInput = true;
                renderer.gammaOutput = true;
                renderer.setClearColor( new THREE.Color(0x000000) );

                container.appendChild(renderer.domElement);

                var geometry = new THREE.BoxGeometry( 70, 70, 70 );
    
                var texture = THREE.ImageUtils.loadTexture( 'assets/images/iako.png' );
                texture.anisotropy = renderer.getMaxAnisotropy();
    
                var material = new THREE.MeshBasicMaterial( { map: texture } );
    
                mesh = new THREE.Mesh( geometry, material );
                mesh.position.x = -300;
                mesh.position.y += 150;
                scene.add( mesh );
    
                // masuo
                var texture_masuo = THREE.ImageUtils.loadTexture( 'assets/images/masuo.jpg' );
                texture_masuo.anisotropy = renderer.getMaxAnisotropy();
    
                var material_masuo = new THREE.MeshBasicMaterial( { map: texture_masuo } );
    
                mesh_masuo = new THREE.Mesh( geometry, material_masuo );
                mesh_masuo.position.x = 300;
                mesh_masuo.position.y += 150;
                scene.add( mesh_masuo ); 
                objects.push( mesh );
                objects.push( mesh_masuo );
    
    
                window.addEventListener( 'resize', onWindowResize, false );
    
            }
    
            function onWindowResize() {
    
                camera.aspect = window.innerWidth / window.innerHeight;
                camera.updateProjectionMatrix();
    
                renderer.setSize( window.innerWidth, window.innerHeight );
    
            }
    
            function animate() {
                var vertexpos = 0;
                var colorpos = 0;
                var numConnected = 0;

                for ( var i = 0; i < particleCount; i++ )
                    particlesData[ i ].numConnections = 0;

                for ( var i = 0; i < particleCount; i++ ) {

                    // get the particle
                    var particleData = particlesData[i];

                    particlePositions[ i * 3     ] += particleData.velocity.x;
                    particlePositions[ i * 3 + 1 ] += particleData.velocity.y;
                    particlePositions[ i * 3 + 2 ] += particleData.velocity.z;

                    if ( particlePositions[ i * 3 + 1 ] < -rHalf || particlePositions[ i * 3 + 1 ] > rHalf )
                        particleData.velocity.y = -particleData.velocity.y;

                    if ( particlePositions[ i * 3 ] < -rHalf || particlePositions[ i * 3 ] > rHalf )
                        particleData.velocity.x = -particleData.velocity.x;

                    if ( particlePositions[ i * 3 + 2 ] < -rHalf || particlePositions[ i * 3 + 2 ] > rHalf )
                        particleData.velocity.z = -particleData.velocity.z;

                    if ( effectController.limitConnections && particleData.numConnections >= effectController.maxConnections )
                        continue;

                    // Check collision
                    for ( var j = i + 1; j < particleCount; j++ ) {

                        var particleDataB = particlesData[ j ];
                        if ( effectController.limitConnections && particleDataB.numConnections >= effectController.maxConnections )
                            continue;

                        var dx = particlePositions[ i * 3     ] - particlePositions[ j * 3     ];
                        var dy = particlePositions[ i * 3 + 1 ] - particlePositions[ j * 3 + 1 ];
                        var dz = particlePositions[ i * 3 + 2 ] - particlePositions[ j * 3 + 2 ];
                        var dist = Math.sqrt( dx * dx + dy * dy + dz * dz );

                        if ( dist < effectController.minDistance ) {

                            particleData.numConnections++;
                            particleDataB.numConnections++;

                            var alpha = 1.0 - dist / effectController.minDistance;

                            positions[ vertexpos++ ] = particlePositions[ i * 3     ];
                            positions[ vertexpos++ ] = particlePositions[ i * 3 + 1 ];
                            positions[ vertexpos++ ] = particlePositions[ i * 3 + 2 ];

                            positions[ vertexpos++ ] = particlePositions[ j * 3     ];
                            positions[ vertexpos++ ] = particlePositions[ j * 3 + 1 ];
                            positions[ vertexpos++ ] = particlePositions[ j * 3 + 2 ];

                            colors[ colorpos++ ] = alpha;
                            colors[ colorpos++ ] = alpha;
                            colors[ colorpos++ ] = alpha;

                            colors[ colorpos++ ] = alpha;
                            colors[ colorpos++ ] = alpha;
                            colors[ colorpos++ ] = alpha;

                            numConnected++;
                        }
                    }
                }


                linesMesh.geometry.drawcalls[ 0 ].count = numConnected * 2;
                linesMesh.geometry.attributes.position.needsUpdate = true;
                linesMesh.geometry.attributes.color.needsUpdate = true;

                pointCloud.geometry.attributes.position.needsUpdate = true;

                requestAnimationFrame( animate );
    
    
                mesh.rotation.x += 0.005;
                mesh.rotation.y += 0.01;
    
                mesh_masuo.rotation.x += 0.005;
                mesh_masuo.rotation.y += 0.01;
    
                renderer.render( scene, camera );
            }

            mesh.callback = function() { 
                window.open("https://twitter.com/IAMAS_girl");
            }
            mesh_masuo.callback = function() { 
                window.open("https://twitter.com/IAMAS_boy");
            }
            var raycaster = new THREE.Raycaster();
            var mouse = new THREE.Vector2();
            
            document.addEventListener( 'mousedown', onDocumentMouseDown, false );
            function onDocumentMouseDown( event ) {
            
                event.preventDefault();
            
                mouse.x = ( event.clientX / renderer.domElement.clientWidth ) * 2 - 1;
                mouse.y = - ( event.clientY / renderer.domElement.clientHeight ) * 2 + 1;
            
                raycaster.setFromCamera( mouse, camera );
            
                var intersects = raycaster.intersectObjects( objects ); 
            
                if ( intersects.length > 0 ) {
                    intersects[0].object.callback();
                }
            
            }

            $('#fullpage').fullpage({
                menu: '#menu',
                anchors: ['1page', '2page', '3page','4page', '5page'],
                sectionsColor: ['none', 'none', 'none', 'none', '#000'],
                afterLoad: function(anchorLink, index){
                    console.log(index);
                    if (index == 2 || index == 4) {
                        mesh.position.y += 15;
                        setTimeout(function(){
                            mesh.position.y -= 15;
                        },100);
                    }

                    if (index == 1 || index == 3) {
                        mesh_masuo.position.y += 15;
                        setTimeout(function(){
                            mesh_masuo.position.y -= 15;
                        },100);
                    }
                    

                    console.log("finish load");
                }
            });
        });
    </script>
    <div id="container"></div>
    <div class="i-head">
        <a href="/">
            <img src="/assets/images/logo.gif" width="150">
        </a>
    </div>
    <div id="fullpage">
        <div class="section active" id="section0"><p class="i-p">マス男: こんな感じなんだけど、ちょっとありきたりかなーと思って...</p></div>
        <div class="section" id="section1"><p class="i-p">イア子: いや...こっちじゃない？</div>
        <div class="section" id="section2"><p class="i-p">マス男: そっかー! じゃあこれでいこう! 筋トレ行ってくるねー！</div>
        <div class="section" id="section3"><p class="i-p">イア子: センスとは...</div>
        <div class="section" id="section4">
            <p class="i-p">
            こうしてIAMAS OPEN HOUSE 2015の非公式Webサイトが立ち上がった!<br><br>
            イア子とマス男は、毎日IAMASの紹介を続けることが出来るのか！？<br><br>
            IAMASの知名度は、この1ヶ月で上がっていくのか！？<br><br>
            IAMAS OPEN HOUSEに受験生は来るのか！？<br><br>
            7月25日 26日のOPEN HOUSE当日まで、毎日見逃すな!<br><br>
            </p>
        </div>
    </div>
    <div class="uk-text-right">
    <ul id="menu">
        <li data-menuanchor="1page" class="active"><a href="#1page" class="uk-icon-circle"></a></li>
        <li data-menuanchor="2page"><a href="#2page" class="uk-icon-circle"></a></li>
        <li data-menuanchor="3page"><a href="#3page" class="uk-icon-circle"></a></li>
        <li data-menuanchor="4page"><a href="#4page" class="uk-icon-circle"></a></li>
        <li data-menuanchor="5page"><a href="#5page" class="uk-icon-circle"></a></li>
    </ul>
    </div>
</body>
</html>
